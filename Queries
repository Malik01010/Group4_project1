## which product was ordered the most (Simple)

SELECT product_name, quantity
FROM `order details` JOIN  Product on `order details`. product_id = Product.Product_id
ORDER BY quantity DESC; 


##How many orders were received in each day (Simple)
SELECT count(order_id)
FROM  `Order`
Group by order_date;


##Check daily sales performance (Simple)
SELECT T.transaction_date, SUM(T.amount_paid) AS daily_sales
FROM Transaction T
GROUP BY T.transaction_date
ORDER BY T.transaction_date DESC;


#Total revenue for each of the payment types (Simple)
SELECT T.payment_method, SUM(T.amount_paid) AS total_revenue
FROM Transaction T
GROUP BY T.payment_method
ORDER BY total_revenue DESC;


## Query to find the average transaction amount per payment method for customers who spent more than $20:
## Complex

SELECT t.payment_method, AVG(t.amount_paid) AS avg_transaction_amount
FROM Transaction t
WHERE t.customer_id IN (
    SELECT c.customer_id
    FROM Customer c
    JOIN `Order` o ON c.customer_id = o.customer_id
    JOIN `order details` od ON o.order_id = od.order_id
    GROUP BY c.customer_id
    HAVING SUM(od.total_price * od.quantity) > 20
)
GROUP BY t.payment_method;
